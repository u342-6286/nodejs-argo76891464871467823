name: Build and Push Docker Image名称：构建和推送Docker镜像

on:   :
  push:   推动:
    branches: [ main ]   分支：[主]
    paths:
      - 'Dockerfile'
      - 'index.js'
      - 'package.json'
  pull_request:
    branches: [ main    分支：   分支：   分支：[主][主][主]]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest   上运行   上运行   上运行:ubuntu-latest:ubuntu-latest:ubuntu-latest
    permissions:
      contents: read   内容   内容   内容:读:读:读
      packages: write   包   包   包:写:写:写

    steps:
      - name   名字: Checkout repository—name：签出存储库—name：签出存储库—name：签出存储库
        uses   使用: actions/checkout@v4用途用途用途:行动/ checkout@v4:行动/ checkout@v4:行动/ checkout@v4

      - name: Log in to GitHub Container Registry—name：登录GitHub Container Registry—name：登录GitHub Container Registry
        uses: docker/login-action@v3用途用途用途:码头工人/ login-action@v3:码头工人/ login-action@v3:码头工人/ login-action@v3
        with:
          registry: ghcr.io   注册中心   注册中心   注册中心:ghcr.io:ghcr.io:ghcr.io
          username: $用户名：$用户名：$用户名：${{github。演员}}{{github。演员}}{{github。演员}}{{ github.actor }}
          password: $密码：$密码：$密码：${{secrets。GITHUB_TOKEN}}{{secrets。GITHUB_TOKEN}}{{secrets。GITHUB_TOKEN}}{{ secrets.GITHUB_TOKEN }}

      - name: Set up Docker Buildx—name：安装Docker Buildx—name：安装Docker Buildx—name：安装Docker Buildx
        uses: docker/setup-buildx-action@v3用途用途用途:码头工人/ setup-buildx-action@v3:码头工人/ setup-buildx-action@v3:码头工人/ setup-buildx-action@v3

      - name: Build and push Docker image- name：构建和推送Docker镜像- name：构建和推送Docker镜像- name：构建和推送Docker镜像
        uses: docker/build-push-action@v5用途用途用途:码头工人/ build-push-action@v5:码头工人/ build-push-action@v5:码头工人/ build-push-action@v5
        with:
          context: .
          push: true
          platforms: linux/amd64,linux/arm64平台平台:linux / amd64, linux / arm64:linux / amd64, linux / arm64
          tags: |
            ghcr.io/${{ github.repository_owner }}/kjkj:2025
          labels: |
            org.opencontainers.image.source=https://github.com/${{ github.repository }}
            org.opencontainers.image.description=HTTP Server
            org.opencontainers.image.licenses=MIT
          cache-from: type=gha
          cache-to: type=gha,mode=max缓存缓存缓存:type = gha模式= max:type = gha模式= max:type = gha模式= max
